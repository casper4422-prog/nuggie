<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width,initial-scale=1">
        <title>ü¶ï Dino Nuggie Manager</title>
        <!-- Hide document content until JS declares it's ready (prevents raw inline JS from flashing) -->
        <style>html:not([data-ready="true"]) { visibility: hidden !important; }</style>
        <link rel="stylesheet" href="main.css">
        <link rel="stylesheet" href="main-additional.css">
    </head>
    <body>
        <!-- Minimal app shell. All JS lives in external files. -->
        <div id="landingPage" class="landing-page" role="main">
            <div class="landing-container">
                <h1 class="landing-title">Dino Nuggie Manager</h1>
                <form id="loginForm">
                    <div class="form-group">
                        <label class="form-label" for="loginEmail">Email</label>
                        <input class="form-control" id="loginEmail" type="email" required autocomplete="username">
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="loginPassword">Password</label>
                        <input class="form-control" id="loginPassword" type="password" required autocomplete="current-password">
                    </div>
                    <button type="submit" class="btn btn-primary login-btn">Login</button>
                </form>
                <div class="login-link">Don't have an account? <a href="#" id="showRegisterLink">Register</a></div>
                <div id="loginError" class="login-error" role="status" aria-live="polite"></div>
            </div>
        </div>

        <div id="registerPage" class="register-page hidden" aria-hidden="true"></div>
        <div id="mainApp" class="hidden" aria-hidden="true">
            <header class="header"><div class="header-content"><div class="header-top">
                <div class="tribe-header" id="tribeHeader">My Tribe</div>
                <div class="header-actions">
                    <button class="btn btn-secondary" id="openTribeBtn">üèõÔ∏è Tribe Settings</button>
                    <button class="btn btn-secondary" id="goToCreaturesBtn">ü¶ñ Creatures</button>
                    <button class="btn btn-secondary" id="goToMyNuggiesBtn">üçó My Nuggies</button>
                    <button id="authBtn" class="btn btn-primary">Sign Out</button>
                </div>
            </div></div></header>
            <main id="appMainContent" role="main"></main>
        </div>

        <!-- Creature modals placeholders -->
        <div class="modal" id="creatureModal" aria-hidden="true"></div>
        <div class="modal" id="creatureDetailModal" aria-hidden="true"></div>

        <!-- Load species database first, then main app logic -->
        <script src="species-database.js"></script>
        <script src="main.js"></script>
    </body>
</html>

            const bloodline = BadgeSystem.calculatePrizedBloodline(creature);
            const previewContent = document.getElementById('badgePreviewContent');
            
            if (bloodline.qualified) {
                const badgeClass = `badge-${bloodline.tier}`;
                previewContent.innerHTML = `
                    <div class="badge ${badgeClass}">${bloodline.tier.toUpperCase()} BLOODLINE</div>
                    <span class="stat-info">Minimum stat: ${bloodline.minStat} points</span>
                `;
            } else {
                previewContent.innerHTML = `
                    <span class="no-badge-qualification">No badge qualification yet</span>
                    <span class="stat-info">‚Ä¢ Need all 5 core stats ‚â•45 for Bronze</span>
                `;
            }
        }

        function saveCreature() {
            const name = document.getElementById('creatureName').value.trim();
            if (!name) {
                alert('Please enter a creature name');
                return;
            }

            const imageInput = document.getElementById('creatureImage');
            const imageElement = document.querySelector('#imagePreview img');
            
            const creatureData = {
                id: appState.editingCreature || generateId(),
                name,
                species: appState.currentSpecies,
                gender: document.getElementById('creatureGender').value,
                level: parseInt(document.getElementById('creatureLevel').value) || 1,
                image: imageElement ? imageElement.src : null,
                baseStats: {
                    Health: parseInt(document.getElementById('baseStatHealth').value) || 0,
                    Stamina: parseInt(document.getElementById('baseStatStamina').value) || 0,
                    Oxygen: parseInt(document.getElementById('baseStatOxygen').value) || 0,
                    Food: parseInt(document.getElementById('baseStatFood').value) || 0,
                    Weight: parseInt(document.getElementById('baseStatWeight').value) || 0,
                    Melee: parseInt(document.getElementById('baseStatMelee').value) || 0
                },
                mutations: {
                    Health: parseInt(document.getElementById('healthMutations').value) || 0,
                    Stamina: parseInt(document.getElementById('staminaMutations').value) || 0,
                    Oxygen: parseInt(document.getElementById('oxygenMutations').value) || 0,
                    Food: parseInt(document.getElementById('foodMutations').value) || 0,
                    Weight: parseInt(document.getElementById('weightMutations').value) || 0,
                    Melee: parseInt(document.getElementById('meleeMutations').value) || 0
                },
                domesticLevels: {
                    Health: parseInt(document.getElementById('healthLevels').value) || 0,
                    Stamina: parseInt(document.getElementById('staminaLevels').value) || 0,
                    Oxygen: parseInt(document.getElementById('oxygenLevels').value) || 0,
                    Food: parseInt(document.getElementById('foodLevels').value) || 0,
                    Weight: parseInt(document.getElementById('weightLevels').value) || 0,
                    Melee: parseInt(document.getElementById('meleeLevels').value) || 0
                },
                notes: document.getElementById('creatureNotes').value,
                createdAt: appState.editingCreature ? 
                    appState.creatures.find(c => c.id === appState.editingCreature)?.createdAt || new Date().toISOString() :
                    new Date().toISOString(),
                updatedAt: new Date().toISOString()
            };

            if (appState.editingCreature) {
                const index = appState.creatures.findIndex(c => c.id === appState.editingCreature);
                appState.creatures[index] = creatureData;
            } else {
                appState.creatures.push(creatureData);
            }

            saveData();
            closeCreatureModal();
            loadCreaturesGrid();
            loadSpeciesGrid();
            updateStatsDashboard();
        }

        // Creature Detail Modal
        function openCreatureDetailModal(creature) {
            appState.selectedCreature = creature;
            document.getElementById('creatureDetailTitle').textContent = creature.name;
            
            const badges = BadgeSystem.generateBadgeHTML(creature);
            const species = SPECIES_DATABASE[creature.species];
            
            document.getElementById('creatureDetailContent').innerHTML = `
                <div class="creature-detail-header">
                    <div class="creature-detail-image-col">
                        ${creature.image ? 
                            `<img src="${creature.image}" alt="${creature.name}" class="creature-detail-image">` :
                            `<div class="creature-detail-image-placeholder">${species?.icon || 'ü¶ñ'}</div>`
                        }
                    </div>
                    <div class="creature-detail-content-col">
                        <div class="creature-detail-title-row">
                            <h3 class="creature-detail-title">${creature.name}</h3>
                            <span class="creature-gender-badge">${creature.gender || 'Unknown'}</span>
                        </div>
                        <div class="creature-detail-badges-row">
                            ${badges}
                        </div>
                        <div class="creature-detail-meta">
                            <strong>Species:</strong> ${creature.species} ‚Ä¢ 
                            <strong>Level:</strong> ${creature.level || 1}
                        </div>
                        ${creature.notes ? `<div class="creature-detail-notes"><strong>Notes:</strong> ${creature.notes}</div>` : ''}
                    </div>
                </div>
                
                <div class="creature-detail-stats-grid">
                    <div>
                        <h4 class="creature-detail-stats-title">üìä Base Stats</h4>
                        ${generateStatTable(creature.baseStats)}
                    </div>
                    <div>
                        <h4 class="creature-detail-stats-title">üß¨ Mutations</h4>
                        ${generateStatTable(creature.mutations)}
                    </div>
                </div>
                
                <div class="creature-detail-domestic">
                    <h4 class="creature-detail-stats-title">üìà Domestic Levels</h4>
                    ${generateStatTable(creature.domesticLevels)}
                </div>
            `;
            
            document.getElementById('creatureDetailModal').classList.add('active');
        }

        function generateStatTable(stats) {
            if (!stats) return '<div class="stat-no-data">No data</div>';
            
            return `
                <div class="stat-table-grid">
                    ${Object.entries(stats).map(([stat, value]) => `
                        <div class="stat-table-cell">
                            <div class="stat-table-label">${stat}</div>
                            <div class="stat-table-value">${value || 0}</div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function closeCreatureDetailModal() {
            document.getElementById('creatureDetailModal').classList.remove('active');
            appState.selectedCreature = null;
        }

        function editCreature() {
            closeCreatureDetailModal();
            openCreatureModal(appState.selectedCreature);
        }

        function deleteCreature() {
            if (confirm(`Are you sure you want to delete ${appState.selectedCreature.name}?`)) {
                appState.creatures = appState.creatures.filter(c => c.id !== appState.selectedCreature.id);
                saveData();
                closeCreatureDetailModal();
                loadCreaturesGrid();
                loadSpeciesGrid();
                updateStatsDashboard();
            }
        }

        // Stats Dashboard
        function updateStatsDashboard() {
            const creatures = appState.creatures;
            const speciesCount = new Set(creatures.map(c => c.species)).size;
            const prizedCount = creatures.filter(c => BadgeSystem.calculatePrizedBloodline(c).qualified).length;
            const highestLevel = creatures.length > 0 ? Math.max(...creatures.map(c => c.level || 1)) : 1;
            
            document.getElementById('totalCreatures').textContent = creatures.length;
            document.getElementById('speciesTracked').textContent = speciesCount;
            document.getElementById('bossReadySpecies').textContent = '0'; // Placeholder
            document.getElementById('prizedBloodlines').textContent = prizedCount;
            document.getElementById('highestLevel').textContent = highestLevel;
        }

        // Data Management
        function generateId() {
            return 'creature_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }

        function saveData() {
            localStorage.setItem('arkCreatures', JSON.stringify(appState.creatures));
        }

        // Initialize the application
  // Only use new SPA navigation logic
    </script>
</script>
<script src="main.js"></script>
</body>
</html>